/**
 * [Component] Masthead > Navigation
 *
 * This contains the website's main navigation component.
 *
 * @category	Component
 * @package		hildon
 * @author		Andi North <andi@mangopear.co.uk>
 * @copyright	2017 Mangopear creative
 * @license   	GNU General Public License <http://opensource.org/licenses/gpl-license.php>
 * @since   	1.5.0
 * @version   	1.5.0
 */


/**
 * CONTENTS
 *
 * [1]	Wrapper
 * [2]	General navigation items
 * [3]	[Nav item] Home
 * [4]	[Nav item] Button-esque items
 * [5]	[Nav item] Basket & cart icon
 * [6]	[Nav item] Textual links
 * [7]	Mobile navigation bar
 * [8]	Navigation toggles buttons
 * [9]	Close navigation action
 * [10]	Responsive: LAP for main navigation items
 * [11]	Responsive: PALM for main navigation items
 */


/**
 * [1]	Wrapper
 * 
 * 		[a]	Fix to top, with suitable size and margin
 * 		[b]	Styling to ensure it stands out
 * 		[c]	Must be after generic `border` for cascade to work
 * 		[d]	Fix sizing on responsive devices
 * 		[e]	Styles needed for the reveal on scroll up, hide on scroll down
 */

.c-main-nav {
	top: 0;
	left: 50%;												// [a]
	width: 100%;											// [a]
	z-index: 20000;											// [a]
	position: fixed;										// [a]
	background: #FFF;										// [b]
	border: 1px solid rgba(0,0,0,0.2);						// [b]
	border-top: 0;											// [b][c]
	box-shadow: 0 3px 10px rgba(0,0,0,0.075);				// [b]
	@include rempx(max-width, 1500px);						// [a]
	@include rempx(margin-left, -750px);					// [a]
	@include mangui-transition(ease-in-out all 300ms);		// [e]


	@include mangui-breakpoint("max-width: 1550px") {		// [d]
		left: 0;											// [d]
		border: 0;
		width: 100%;										// [d]
		margin-left: 0;										// [d]
	}														// [d]



	&.is-hidden  { @include mangui-transform(translateY(-100%)); }		// [e]
	&.is-visible { @include mangui-transform(translateY(0%));    }		// [e]
}





	/**
	 * [2]	General navigation items
	 */
	
	.c-main-nav {
		.o-nav__item {
			vertical-align: middle;
		}


			.o-nav__link {
				color: $grey--dark;
				font-family: $font--playfair;
				@include rempx(font-size, 16px);
				

				&:hover, &:active, &:focus { color: $blue--medium; }
			}
	}
	




	/**
	 * [3]	[Nav item] Home
	 */
	
	.o-nav__item--home {
		.o-nav__link {
			color: $blue--dark;
			@include rempx(margin, 0 10px 0 20px);
			@include rempx(padding, 22px 15px 18px);


			@include mangui-breakpoint("max-width: 450px") {
				margin: 0;
				padding: 0;
			}


			&:hover, &:active, &:focus {
				color: $blue--medium;
			}
		}
	}





	/**
	 * [4]	[Nav item] Button-esque items
	 *
	 * 		Such as search, account and basket.
	 */
	
	.o-nav__item--button-esque {
		@include mangui-breakpoint(desk) {
			@include rempx(top, 13px);
			position: absolute;
		}


		.o-nav__link {
			color: $grey--dark;
			background: $grey--light;


			&:hover, &:active, &:focus {
				color: #FFF;
				background: $blue--medium;
			}
		}


			.o-nav__icon {
				bottom: -0.2em;
				position: relative;
			}


		@include mangui-breakpoint(desk) {
			&.o-nav__item--cart 	{ @include rempx(right,  79px); }
			&.o-nav__item--account 	{ @include rempx(right,  20px); }
		}
	}





	/**
	 * [5]	[Nav item] Basket & cart icon
	 */
	
	.o-nav__item--cart {
		.o-nav__link {
			color: #FFF;
			background: $blue--light;
			font-family: $font--core;
			@include rempx(padding-left, 20px);
			@include rempx(padding-right, 20px);
			@include rempx(padding-bottom, 7px);


			&.has-added { background: $green; }


			&:hover, &:active, &:focus {
				.c-cart-header__count { background: mangui-shade($blue--medium, 30%); }
			}
		}


			.o-nav__icon {
				opacity: .7;
			}


			.o-nav__content {
				top: -3px;
				padding-left: 6px;
				position: relative;
			}


				.c-cart-header__amount {
					padding: 0 0 0 15px;
					@include mangui-breakpoint("max-width: 360px") { display: none; }


					.woocommerce-Price-amount {
						font-weight: bold;
					}


					.woocommerce-Price-currencySymbol {
						opacity: .8;
						font-size: .85em;
						padding-right: 2px;
						font-weight: normal;
					}
				}


				.c-cart-header__count {
					top: -1px;
					color: #FFF;
					position: absolute;
					text-align: center;
					border-radius: 50%;
					display: inline-block;
					background: $blue--medium;
					@include rempx(left, -9px);
					@include rempx(width, 20px);
					@include rempx(font-size, 11px);
					@include rempx(padding, 1px 0 0);
					@include rempx(line-height, 19px);
					@include mangui-transition(ease-in-out 350ms all);


					@include mangui-breakpoint("max-width: 360px") {
						@include rempx(top, -16px);
						@include rempx(left, -44px);
					}
				}
	}





	/**
	 * [6]	[Nav item] Textual links
	 *
	 * 		[a]	Strange transition rules to ensure sub navs fade in
	 * 			and out smoothly
	 */
	
	.o-nav__item--textual {
		&:hover, &:active, &:focus, &.is-in-focus {
			.o-nav__list--sub {
				left: 0;
				opacity: 1;
				pointer-events: auto;
				@include mangui-transform(translateY(0px));
				@include mangui-transition(ease-in-out 350ms all, ease-in-out 0ms left);					// [a]
			}
		}


			> .o-nav__link {
				font-weight: bold;
				color: $grey--dark;
				position: relative;
				font-family: $font--playfair;
				@include rempx(font-size, 20px);
				@include rempx(padding, 18px 20px 21px);
				@include mangui-transition(ease-in-out 400ms all);
				@include mangui-breakpoint(portable) { @include rempx(padding, 22px 48px 21px 18px); }


				&::before {
					content: '';
					bottom: 0;
					opacity: 0;
					position: absolute;
					border-bottom: 3px solid;
					@include rempx(left, 18px);
					@include rempx(right, 18px);
					@include mangui-transform(scaleX(0));
					@include mangui-transition(linear 250ms 50ms opacity, ease-in-out 400ms transform);
				}


				&:hover, &:active, &:focus {
					color: $blue--medium;


					&::before {
						opacity: 1;
						@include mangui-transform(scaleX(1));
					}
				}
			}


			.o-nav__list--sub {
				background: #FFF;
				border: 1px solid rgba(0,0,0,0.2);
				border-top: 0;
				@include rempx(width, 200px);
				@include mangui-transform(translateY(-8px));
				@include mangui-transition(ease-in-out 350ms all, ease-in-out 0ms 350ms left);				// [a]


				.o-nav__link {
					@include rempx(padding, 8px 18px);
					@include mangui-transition(ease-in-out all 500ms);
					@include mangui-breakpoint(portable) { @include rempx(padding, 17px 20px 18px); }


					&:hover, &:active, &:focus {
						background: rgba(black, .05);
						@include mangui-transition(ease-in-out all 100ms);
					}
				}
			}
	}





	/**
	 * [7]	Mobile navigation bar
	 */
	
	.c-main-nav__mobile {
		.o-nav__list {

		}


			.o-nav__item {
				&--reveal { width: 40%; text-align: left; }
				&--home   { width: 20%; text-align: center; }
				&--cart   { width: 40%; text-align: right; }
			}


				.o-nav__item--reveal {
					.o-nav__link {
						border: 0;
						background: none;
						border-right: 1px solid transparent;
						@include mangui-transition(ease-in-out 350ms all);


						&:hover, &:active, &:focus, &.is-active {
							color: #FFF;
							background: $blue--light;
							border-right-color: $blue--medium;
						}


						.o-nav__content {
							font-size: .85em;
							position: relative;
							text-transform: uppercase;
							@include rempx(top, -4px);
							@include rempx(padding, 0 2px 0 5px);
						}


							.o-nav__icon--reveal {
								opacity: 1;
								@include mangui-transition(ease-in-out 500ms all, ease 0ms color);
							}
							

							.o-nav__icon--close {
								top: 11px;
								left: 15px;
								opacity: 0;
								position: absolute;
								@include mangui-transition(ease-in-out 500ms all, ease 0ms color);
							}


							&.is-active {
								.o-nav__icon--reveal {
									opacity: 0;
									@include mangui-transform(rotate(360deg));
								}
								

								.o-nav__icon--close {
									opacity: 1;
									@include mangui-transform(rotate(360deg));
								}
							}
					}
				}


				.o-nav__item--home {
					.o-nav__link {
						padding-bottom: 0;
						@include rempx(padding-top, 5px);
					}
				}


				.o-nav__item--cart {
					.o-nav__link {
						background: none;
						color: $grey--dark;
						border-left: 1px solid transparent;
						@include rempx(padding, 8px 10px 7px);


						&:hover, &:active, &:focus {
							color: #FFF;
							background: $blue--light;
							border-left-color: $blue--medium;
						}
					}


						.c-cart-header__count {
							@include rempx(width, 17px);
							@include rempx(font-size, 9px);
							@include rempx(line-height, 16px);
						}


						.c-cart-header__amount { @include rempx(padding-left, 6px); }
						.o-nav__icon, .o-nav__content { display: inline-block; }
				}


					.o-nav__link {
						display: inline-block;
					}
	}





	/**
	 * [8]	Navigation toggles buttons
	 */

	.o-nav__toggle {
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		width: 100%;
		font-size: 0;
		text-align: right;
		position: absolute;
		@include rempx(padding, 0 15px);


		.o-nav__toggle-icon {
			display: inline-block;
		}
	}





	/**
	 * [9]	Close navigation action
	 */
	
	.c-close-mobile-nav {
		top: 0;
		left: 0;
		right: 0;
		bottom: 0;
		opacity: 0;
		z-index: 19999;
		position: fixed;
		background: rgba(black, .6);
		@include mangui-transform(translateX(-100%));
		@include mangui-transition(ease 0ms 500ms all, ease-in-out 500ms 0ms opacity);


		&.is-showing {
			opacity: 1;
			@include mangui-transform(translateX(0));
			@include mangui-transition(ease 0ms 0ms all, ease-in-out 500ms 0ms opacity);
		}
	}





	/**
	 * [10]	Responsive for main navigation items
	 */

	@include mangui-breakpoint(portable) {
		.c-main-nav { background: none; }
			.c-main-nav__mobile { background: #FFF; }


			.c-main-nav__desktop {
				left: 0;
				bottom: 0;
				opacity: 0;
				position: fixed;
				overflow: hidden;
				background: #FFF;
				pointer-events: none;
				@include rempx(top, 47px);
				@include rempx(width, 300px);
				@include mangui-transform(translateX(-100%));
				@include mangui-transition(ease-in-out 500ms all);


				&.is-showing {
					opacity: 1;
					pointer-events: auto;
					@include mangui-transform(translateX(0));
				}


				.o-nav__list {

				}


					.o-nav__item {
						width: 100%;
						border-bottom: 1px solid $grey--light;


						&--textual {
							.o-nav__list--sub {
								top: 0;
								left: 0;
								border: 0;
								z-index: 22;
								height: 100vh;
								padding-top: 0;
								position: fixed;
								background: #FFF;
								@include rempx(width, 300px);
								@include rempx(margin-left, 300px);
								@include mangui-transform(translateX(0));
								@include mangui-transition(ease-in-out 500ms all);


								.o-nav__link--go-back {
									width: 100%;
									text-align: left;
									@include rempx(padding, 15px 20px);
									

									.o-nav__icon { @include rempx(margin, 5px 10px -7px -8px); }
								}
							}


							&.is-in-focus {
								.o-nav__list--sub {
									@include mangui-transform(translateX(-100%));
								}
							}
						}


						&--account {
							.o-nav__link {
								background: none;
								@include rempx(padding, 16px 17px 16px);

								&:hover, &:active, &:focus { color: $blue--medium; }
								.o-nav__icon { @include rempx(margin, 0 10px -4px 0); }
							}
						}
					}


						.o-nav__link--top-level {
							@include rempx(padding, 15px 20px);
						}
			}
	}